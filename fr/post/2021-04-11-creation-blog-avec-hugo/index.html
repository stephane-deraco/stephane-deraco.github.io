<!doctype html><html lang=fr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Création d'un blog avec Hugo | Blog de Stéphane</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="De manière tout à fait non originale, le premier post de ce blog indique de quelle façon il est généré et hébergé.
Choix du moteur Ce blog est statique, il ne repose pas sur un gestionnaire de contenu type Wordpress ou autre. Au contraire, toutes les pages sont générées en amont en HTML/CSS/JS et sont servies de manière statique. L&rsquo;outil pour générer ces pages est Hugo.
Hugo prend en entrée des fichiers au format Markdown, et génère le HTML associé."><meta name=generator content="Hugo 0.83.1"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/ananke/dist/main.css_5c99d70a7725bacd4c701e995b969fea.css><meta property="og:title" content="Création d'un blog avec Hugo"><meta property="og:description" content="De manière tout à fait non originale, le premier post de ce blog indique de quelle façon il est généré et hébergé.
Choix du moteur Ce blog est statique, il ne repose pas sur un gestionnaire de contenu type Wordpress ou autre. Au contraire, toutes les pages sont générées en amont en HTML/CSS/JS et sont servies de manière statique. L&rsquo;outil pour générer ces pages est Hugo.
Hugo prend en entrée des fichiers au format Markdown, et génère le HTML associé."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.deraco.fr/fr/post/2021-04-11-creation-blog-avec-hugo/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-10T14:54:31+02:00"><meta property="article:modified_time" content="2021-04-10T14:54:31+02:00"><meta property="og:site_name" content="Blog de Stéphane"><meta itemprop=name content="Création d'un blog avec Hugo"><meta itemprop=description content="De manière tout à fait non originale, le premier post de ce blog indique de quelle façon il est généré et hébergé.
Choix du moteur Ce blog est statique, il ne repose pas sur un gestionnaire de contenu type Wordpress ou autre. Au contraire, toutes les pages sont générées en amont en HTML/CSS/JS et sont servies de manière statique. L&rsquo;outil pour générer ces pages est Hugo.
Hugo prend en entrée des fichiers au format Markdown, et génère le HTML associé."><meta itemprop=datePublished content="2021-04-10T14:54:31+02:00"><meta itemprop=dateModified content="2021-04-10T14:54:31+02:00"><meta itemprop=wordCount content="1441"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Création d'un blog avec Hugo"><meta name=twitter:description content="De manière tout à fait non originale, le premier post de ce blog indique de quelle façon il est généré et hébergé.
Choix du moteur Ce blog est statique, il ne repose pas sur un gestionnaire de contenu type Wordpress ou autre. Au contraire, toutes les pages sont générées en amont en HTML/CSS/JS et sont servies de manière statique. L&rsquo;outil pour générer ces pages est Hugo.
Hugo prend en entrée des fichiers au format Markdown, et génère le HTML associé."></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/fr/ class="f3 fw2 hover-white no-underline white-90 dib">Blog de Stéphane</a><div class="flex-l items-center"><h4></h4><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/en/post/2021-04-11-create-a-blog-with-hugo/>en</a></li></ul><a href=https://twitter.com/stephane_deraco target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/stephane-deraco target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://blog.deraco.fr/fr/post/2021-04-11-creation-blog-avec-hugo/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://blog.deraco.fr/fr/post/2021-04-11-creation-blog-avec-hugo/&text=Cr%c3%a9ation%20d%27un%20blog%20avec%20Hugo" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blog.deraco.fr/fr/post/2021-04-11-creation-blog-avec-hugo/&title=Cr%c3%a9ation%20d%27un%20blog%20avec%20Hugo" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Création d'un blog avec Hugo</h1><time class="f6 mv4 dib tracked" datetime=2021-04-10T14:54:31+02:00>April 10, 2021</time>
<span class="f6 mv4 dib tracked">- 7 minutes read</span>
<span class="f6 mv4 dib tracked">- 1441 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>De manière tout à fait non originale, le premier post de ce blog indique de quelle façon il est généré et hébergé.</p><h1 id=choix-du-moteur>Choix du moteur</h1><p>Ce blog est statique, il ne repose pas sur un gestionnaire de contenu type Wordpress ou autre.
Au contraire, toutes les pages sont générées en amont en HTML/CSS/JS et sont servies de manière statique.
L&rsquo;outil pour générer ces pages est <a href=https://gohugo.io>Hugo</a>.</p><p>Hugo prend en entrée des fichiers au format Markdown, et génère le HTML associé.
Il existe de nombreuses extensions pour ajouter des fonctionnalités.</p><h1 id=mise-en-place>Mise en place</h1><p>Commencer par télécharger et installer Hugo en suivant les <a href=https://gohugo.io/getting-started/installing/>instructions officielles</a>.</p><p>Ensuite, pour créer un nouveau site, taper la commande suivante :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hugo new site blog
</code></pre></div><p>Puis, pour ajouter un thème, on va mettre en place un <em>submodule</em> au sens git, il faut donc initialiser le dépôt git et ajouter le thème comme comme suit :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd blog
git init
git submodule add https://github.com/theNewDynamic/gohugo-theme-ananke.git themes/ananke
</code></pre></div><p>Ici, le thème par défaut est utilisé, mais il en existe <a href=https://themes.gohugo.io/>beaucoup d&rsquo;autres</a>.</p><p>Une fois le thème ajouté, il faut l&rsquo;indiquer dans la configuration qui se trouve par défaut dans le fichier <code>config.toml</code>.
Hugo supporte aussi le format <em>YAML</em> pour ce fichier de configuration, ce que je vais utiliser :</p><blockquote><p><em>config.yaml</em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>baseURL</span>: <span style=color:#ae81ff>http://example.org/</span>
<span style=color:#f92672>languageCode</span>: <span style=color:#ae81ff>fr-fr</span>
<span style=color:#f92672>title</span>: <span style=color:#ae81ff>Blog de Stéphane</span>
<span style=color:#f92672>theme</span>: <span style=color:#ae81ff>ananke</span>
</code></pre></div></blockquote><h2 id=configuration-du-thème>Configuration du thème</h2><p>Chaque thème vient avec ses propres possibilités de configuration et d&rsquo;extension.</p><p>Par exemple, pour ce thème, il est possible d&rsquo;ajouter les paramètres suivants :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>params</span>:
  <span style=color:#f92672>show_reading_time</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>twitter</span>: <span style=color:#ae81ff>https://twitter.com/stephane_deraco</span>
  <span style=color:#f92672>github</span>: <span style=color:#ae81ff>https://github.com/stephane-deraco</span>
</code></pre></div><p>Il est possible d&rsquo;aller plus loin en personnalisant les aspects visuels classiques (couleur de fond, images, &mldr;) ou même d&rsquo;utiliser un fichier CSS personnalisé.</p><h2 id=création-dune-nouvelle-entrée-de-blog>Création d&rsquo;une nouvelle entrée de blog</h2><p>Pour créer un nouveau post, il suffit de taper la commande suivante :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hugo new posts/2021-04-11-creation-blog-avec-hugo.md
</code></pre></div><p>Cela a pour effet de créer un nouveau fichier dans le répertoire <code>content/posts</code>.
Par défaut, l&rsquo;entrée est en mode <em>draft</em> (<code>draft: true</code> dans l&rsquo;entête), ce qui signifie que lors de la construction du site, elle ne sera pas générée.
Cependant, pour voir le contenu en local, on peut utiliser la commande :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hugo server -D
</code></pre></div><ul><li><code>hugo server</code> permet de construire en local les pages, lance un serveur web et scrute les modifications pour reconstruire à la volée les pages et rafraichir le navigateur grâce à une fonction de <em>live reload</em></li><li>le flag <code>-D</code> indique de générer également les pages <em>drafts</em></li></ul><h1 id=hébergement>Hébergement</h1><p>Comme au final le site est constitué uniquement de ressources statiques, n&rsquo;importe quel hébergement de base peut suffire.</p><p>Ici, je profite de la fonctionnalité Githup Pages pour héberger et servir le blog.</p><h2 id=construire-le-site>Construire le site</h2><p>La première étape est de construire le site.
Pour cela, la commande à exécuter est :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>HUGO_ENV<span style=color:#f92672>=</span>production hugo
</code></pre></div><p>Les fichiers constituant le site sont alors générés dans le répertoire <code>public</code>.</p><blockquote><p><strong>Note</strong> : Normalement, seule la commande <code>hugo env</code> est nécessaire, mais la documentation du thème utilisé indique qu&rsquo;il faut positionner la variable <code>HUGO_ENV</code> à <code>production</code>.</p></blockquote><blockquote><p><strong>Note</strong> : Ne pas oublier d&rsquo;enlever le statut <code>draft</code> des pages que l&rsquo;on souhaite publier.</p></blockquote><blockquote><p><strong>Note</strong> : Dans le fichier <code>config.yaml</code>, la valeur de <code>baseURL</code> sera utilisée pour les liens, notamment depuis la page d&rsquo;accueil vers les articles.
Par défaut, c&rsquo;est <code>example.org</code>. Il faut bien évidemment modifier cette valeur pour mettre l&rsquo;adresse où le site sera hébergé. Cependant, pour s&rsquo;assurer que la génération des pages fonctionne, on peut utiliser la commande <code>hugo -b http://localhost:8000/</code>, lancer la génération, se placer dans le répertoire <code>public</code> et lancer un serveur web depuis ce répertoire par exemple avec <code>python3 -m http.server</code>.</p></blockquote><h2 id=publication-du-site>Publication du site</h2><p>Le site sera hébergé en utilisant la fonctionnalité <a href=https://guides.github.com/features/pages/>Github <em>Pages</em></a>.
Il faut commencer par créer sur Github un nouveau dépôt ayant en nom <code>username.github.io</code> avec <em>username</em> le nom d&rsquo;utilisateur Github.
C&rsquo;est ce dépôt qui sera utilisé pour le contenu du site.</p><p>La <a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>documentation de Hugo</a> indique la marche à suivre.</p><blockquote><p><strong>Note</strong> : On trouvera sur le web une solution à base de submodules Git afin de garder deux dépôts différents, un pour le code du site et un pour le résultat de la génération.
Avec les <em>Github Actions</em>, comme indiqué sur le site de Hugo, tout cela est grandement simplifié.</p></blockquote><p>Il faut également créer le dépôt qui va contenir le code source.
Au final, les deux dépôts suivants seront utilisés :</p><ul><li><a href=https://github.com/stephane-deraco/blog.git>https://github.com/stephane-deraco/blog.git</a> pour le code source du blog</li><li><a href=https://github.com/stephane-deraco/stephane-deraco.github.io.git>https://github.com/stephane-deraco/stephane-deraco.github.io.git</a> pour le site</li></ul><p>La génération et la publication se fait avec les Github Actions.
Comme indiqué, il faut créer le fichier suivant :</p><blockquote><p><em>.github/workflows/gh-pages.yml</em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>name</span>: <span style=color:#ae81ff>github pages</span>

<span style=color:#f92672>on</span>:
  <span style=color:#f92672>push</span>:
    <span style=color:#f92672>branches</span>:
      - <span style=color:#ae81ff>main </span> <span style=color:#75715e># Set a branch to deploy</span>
  <span style=color:#f92672>pull_request</span>:

<span style=color:#f92672>jobs</span>:
  <span style=color:#f92672>deploy</span>:
    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-20.04</span>
    <span style=color:#f92672>steps</span>:
      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>  <span style=color:#75715e># Fetch Hugo themes (true OR recursive)</span>
          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>    <span style=color:#75715e># Fetch all history for .GitInfo and .Lastmod</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;latest&#39;</span>
          <span style=color:#75715e># extended: true</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>
        <span style=color:#f92672>env</span>:
          <span style=color:#f92672>HUGO_ENV</span>: <span style=color:#ae81ff>production</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3</span>
        <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.ref == &#39;refs/heads/main&#39;</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>deploy_key</span>: <span style=color:#ae81ff>${{ secrets.ACTIONS_DEPLOY_KEY }}</span>
          <span style=color:#f92672>external_repository</span>: <span style=color:#ae81ff>stephane-deraco/stephane-deraco.github.io</span>
          <span style=color:#f92672>publish_branch</span>: <span style=color:#ae81ff>main</span>
          <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span>
</code></pre></div></blockquote><p>Par rapport à la version proposée sur le site d&rsquo;Hugo, ici on indique de pousser le résultat de la construction du site sur un autre dépôt que celui d&rsquo;origine (<code>external_repository</code>), comme documenté sur le <a href=https://github.com/marketplace/actions/github-pages-action#%EF%B8%8F-deploy-to-external-repository-external_repository>site de l&rsquo;action Github <code>peaceiris/actions-gh-pages</code></a>.</p><p>Comme l&rsquo;action Github doit interagir avec un dépôt différent de celui à l&rsquo;origine de l&rsquo;action, il faut créer une <a href=https://github.com/marketplace/actions/github-pages-action#%EF%B8%8F-create-ssh-deploy-key>clé SSH de déploiement</a> :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ssh-keygen -t rsa -b <span style=color:#ae81ff>4096</span> -C <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>git config user.email<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> -f gh-pages -N <span style=color:#e6db74>&#34;&#34;</span>
</code></pre></div><p>Puis aller dans le dépôt Github qui contiendra le résultat du site (<code>stephane-deraco.github.io</code>) > <em>Settings</em> > <em>Deploy keys</em>, cliquer sur le bouton <em>Add deploy key</em> et y copier la clé <strong>publique</strong> (le contenu du fichier <code>gh-pages.pub</code> généré par la commande précédente), et cocher <em>Allow write access</em>.</p><p>Aller maintenant dans le dépôt Github qui contiendra le code Markdown (<code>blog</code>) > <em>Secrets</em> et ajouter la clé <strong>privée</strong> (le fichier <code>gh-pages</code>) en cliquant sur le bouton <em>New repository secret</em>.
Utiliser <code>ACTIONS_DEPLOY_KEY</code> comme nom (cela doit correspondre à ce que l&rsquo;on a mis dans l&rsquo;action Github).</p><p>On peut maintenant faire un commit et pousser le contenu du dépôt <code>blog</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git add .
git commit -m <span style=color:#e6db74>&#34;First blog post&#34;</span>
git remote add origin https://github.com/stephane-deraco/blog.git
git branch -M main
git push -u origin main
</code></pre></div><p>L&rsquo;action Github va se déclencher, et quelques instants après le dépôt contenant le site sera mis à jour avec le résultat de la construction par Hugo.</p><h2 id=mise-en-place-dun-domaine-personnel>Mise en place d&rsquo;un domaine personnel</h2><p>Avec les opérations précédentes, le site est déjà disponible sur <a href=https://stephane-deraco.github.io/>https://stephane-deraco.github.io/</a>.</p><p>Afin qu&rsquo;il soit disponible sur un autre site personnel (par exemple <a href=https://blog.deraco.fr>https://blog.deraco.fr</a>), il faut suivre les <a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/#use-a-custom-domain>instructions d&rsquo;Hugo pour mettre en place un domaine personnalisé</a>.</p><h3 id=configuration-dhugo>Configuration d&rsquo;Hugo</h3><p>Il suffit de créer un fichier <code>static/CNAME</code> avec en contenu uniquement le domaine personnalisé :</p><blockquote><p><em>static/CNAME</em></p><pre><code>blog.deraco.fr
</code></pre></blockquote><h3 id=configuration-de-github>Configuration de Github</h3><p>Côté Github, <a href=https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site#configuring-a-subdomain>la documentation</a> précise qu&rsquo;il faut configurer le domaine dans le menu <em>Settings</em> > <em>Pages</em> du dépôt contenu le résultat généré du site statique (ici <code>stephane-deraco.github.io</code>).</p><p>Renseigner ensuite le domaine (<code>blog.deraco.fr</code>) dans <em>Custom domain</em>, et enregistrer.</p><h3 id=configuration-du-fournisseur-de-domaine>Configuration du fournisseur de domaine</h3><p>Il faut ensuite <em>prouver</em> à Github que l&rsquo;on possède bien le domaine personnalisé en question, et configurer le DNS.
Pour cela, la méthode est d&rsquo;ajouter un enregistrement <code>CNAME</code> dans la console de notre fournisseur de domaine.</p><p>Chez <a href=https://www.gandi.net/>Gandi</a>, il suffit de se connecter à la console, d&rsquo;aller dans la partie <em>Domains</em> puis cliquer sur <em>Add DNS record</em>.
Les deux paramètres importants sont :</p><ul><li>Name : <code>blog.deraco.fr</code></li><li>Hostname : <code>stephane.deraco.github.io.</code> (<strong>Attention à ne pas oublier le point final !</strong>)</li></ul><p>Il faut maintenant attendre que la propagation DNS se fasse.</p><h3 id=https>HTTPS</h3><p>Comme le site est au final hébergé sur un domaine de Github, le certificat présenté par le site ne correspondra pas au domaine personnalisé, et le navigateur affichera un erreur du type :</p><blockquote><p>Les sites web justifient leur identité par des certificats. Firefox ne fait pas confiance à ce site, car il utilise un certificat qui n’est pas valide pour blog.deraco.fr. Le certificat est seulement valide pour les noms suivants : <a href=http://www.github.com>www.github.com</a>, *.github.com, github.com, *.github.io, github.io, *.githubusercontent.com, githubusercontent.com</p><p>Code d’erreur : SSL_ERROR_BAD_CERT_DOMAIN</p></blockquote><p>En rafraichissant régulièrement la page Github du site (<em>Settings</em> > <em>Pages</em>), on peut voir d&rsquo;une part le statut de la vérification du domaine personnalisé, et d&rsquo;autre part qu&rsquo;un certificat est en cours de génération.</p><h3 id=modification-de-configyaml>Modification de <code>config.yaml</code></h3><p>Comme le site est maintenant disponible sur une autre addresse, il faut modifier le paramètre <code>baseURL</code> du fichier <code>config.yaml</code> afin de pointer sur le domaine personnalisé.</p><h1 id=conclusion>Conclusion</h1><p>Nous avons donc un site avec son propre domaine, hébergé par Github Pages (qui gère également son certificat), et dont le contenu statique est généré par Github Action lors de commits sur le code source du site, rédigé en Markdown et transformé par Hugo.</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://blog.deraco.fr/>&copy; Blog de Stéphane 2021</a><div><a href=https://twitter.com/stephane_deraco target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/stephane-deraco target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></footer></body></html>