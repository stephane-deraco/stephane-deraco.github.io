<!doctype html><html lang=fr>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Détecteur de puissance de signal Wifi | Blog de Stéphane</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="Lors d&rsquo;une précédente conférence Devoxx France, Clever-Cloud avait un stand où ils faisaient la démonstration de leur plateforme avec un petit chipset qui contrôlait une bande LED, le tout étant piloté par une websocket communiquant avec le backend hébergé sur Clever-Cloud. Les infos sur ce projet sont sur Github : https://github.com/CleverCloud/wemos-statsd-example.
Cette bande LED et le chipset étaient distribués en goodies :)
J&rsquo;ai récemment retrouvé cette bande LED dans une boîte, et j&rsquo;ai eu envie de jouer avec.">
<meta name=generator content="Hugo 0.88.1">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link rel=stylesheet href=/ananke/css/main.min.8ca51ad9680f6f5bb4adc9140a88775d0b6638471cd8aa5fc091c9e308bdacdd.css>
<meta property="og:title" content="Détecteur de puissance de signal Wifi">
<meta property="og:description" content="Lors d&rsquo;une précédente conférence Devoxx France, Clever-Cloud avait un stand où ils faisaient la démonstration de leur plateforme avec un petit chipset qui contrôlait une bande LED, le tout étant piloté par une websocket communiquant avec le backend hébergé sur Clever-Cloud. Les infos sur ce projet sont sur Github : https://github.com/CleverCloud/wemos-statsd-example.
Cette bande LED et le chipset étaient distribués en goodies :)
J&rsquo;ai récemment retrouvé cette bande LED dans une boîte, et j&rsquo;ai eu envie de jouer avec.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.deraco.fr/fr/post/2021-09-19-wifi-signal-detector/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-09-19T00:00:00+00:00">
<meta property="article:modified_time" content="2021-09-19T00:00:00+00:00"><meta property="og:site_name" content="Blog de Stéphane">
<meta itemprop=name content="Détecteur de puissance de signal Wifi">
<meta itemprop=description content="Lors d&rsquo;une précédente conférence Devoxx France, Clever-Cloud avait un stand où ils faisaient la démonstration de leur plateforme avec un petit chipset qui contrôlait une bande LED, le tout étant piloté par une websocket communiquant avec le backend hébergé sur Clever-Cloud. Les infos sur ce projet sont sur Github : https://github.com/CleverCloud/wemos-statsd-example.
Cette bande LED et le chipset étaient distribués en goodies :)
J&rsquo;ai récemment retrouvé cette bande LED dans une boîte, et j&rsquo;ai eu envie de jouer avec."><meta itemprop=datePublished content="2021-09-19T00:00:00+00:00">
<meta itemprop=dateModified content="2021-09-19T00:00:00+00:00">
<meta itemprop=wordCount content="1177">
<meta itemprop=keywords content="wifi,arduino,esp8266,clever-cloud,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Détecteur de puissance de signal Wifi">
<meta name=twitter:description content="Lors d&rsquo;une précédente conférence Devoxx France, Clever-Cloud avait un stand où ils faisaient la démonstration de leur plateforme avec un petit chipset qui contrôlait une bande LED, le tout étant piloté par une websocket communiquant avec le backend hébergé sur Clever-Cloud. Les infos sur ce projet sont sur Github : https://github.com/CleverCloud/wemos-statsd-example.
Cette bande LED et le chipset étaient distribués en goodies :)
J&rsquo;ai récemment retrouvé cette bande LED dans une boîte, et j&rsquo;ai eu envie de jouer avec.">
</head>
<body class="ma0 avenir bg-near-white production">
<header class="cover bg-top" style=background-image:url(https://blog.deraco.fr/images/2021-09-19-wifi-arduino.jpg)>
<div class="pb3-m pb6-l bg-black-60">
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/fr/ class="f3 fw2 hover-white no-underline white-90 dib">
Blog de Stéphane
</a>
<div class="flex-l items-center">
<h4></h4>
<ul class="pl0 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/en/post/2021-09-19-wifi-signal-detector/>en</a>
</li>
</ul>
<ul class="pl0 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/fr/tags title=Tags>
Tags
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/fr/about/ title="À propos page">
À propos
</a>
</li>
</ul>
<a href=https://twitter.com/stephane_deraco target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/st%C3%A9phane-deraco-964640194/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/stephane-deraco target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://blog.deraco.fr/fr/index.xml target=_blank class="link-transition rss link dib z-999 pt3 pt0-l mr1" title="RSS link" rel=noopener aria-label="RSS——Opens in a new window"><svg xmlns="http://www.w3.org/2000/svg" height="32" width="32" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</nav>
<div class="tc-l pv6 ph3 ph4-ns">
<h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Détecteur de puissance de signal Wifi</h1>
</div>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class=mt3>
<a href="https://www.facebook.com/sharer.php?u=https://blog.deraco.fr/fr/post/2021-09-19-wifi-signal-detector/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a href="https://twitter.com/share?url=https://blog.deraco.fr/fr/post/2021-09-19-wifi-signal-detector/&text=D%c3%a9tecteur%20de%20puissance%20de%20signal%20Wifi" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blog.deraco.fr/fr/post/2021-09-19-wifi-signal-detector/&title=D%c3%a9tecteur%20de%20puissance%20de%20signal%20Wifi" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 athelas mt3 mb1">Détecteur de puissance de signal Wifi</h1>
<time class="f6 mv4 dib tracked" datetime=2021-09-19T00:00:00Z>2021-09-19</time>
<span class="f6 mv4 dib tracked"> - 6 minutes de lecture </span>
<span class="f6 mv4 dib tracked"> - 1177 mots</span>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Lors d&rsquo;une précédente conférence Devoxx France, <a href=https://www.clever-cloud.com/>Clever-Cloud</a> avait un stand où ils faisaient la démonstration de leur plateforme avec un petit chipset qui contrôlait une bande LED, le tout étant piloté par une websocket communiquant avec le backend hébergé sur Clever-Cloud.
Les infos sur ce projet sont sur Github : <a href=https://github.com/CleverCloud/wemos-statsd-example>https://github.com/CleverCloud/wemos-statsd-example</a>.</p>
<p>Cette bande LED et le chipset étaient distribués en goodies :)</p>
<p>J&rsquo;ai récemment retrouvé cette bande LED dans une boîte, et j&rsquo;ai eu envie de jouer avec.
Sur un autre projet, j&rsquo;ai testé un petit instrument Flower Care qui mesure l&rsquo;ensoleillement, l&rsquo;humidité du sol, la température, etc.
Le souci est qu&rsquo;il ne communique qu&rsquo;en Bluetooth LE, et il est planté trop loin du Raspberry Pi (qui est dans la maison) pour pouvoir envoyer ses données.</p>
<p>L&rsquo;idée était donc de faire un relai avec un RPi Zero, et je voulais voir jusqu&rsquo;où je pouvais aller dans le jardin tout en continuant à capter le signal Wifi de ma box.</p>
<p>Il y a très certainement des applications smartphones qui font ça très bien, mais c&rsquo;est moins fun que de jouer avec une bande LED :)</p>
<h2 id=préparation>Préparation</h2>
<h3 id=composants>Composants</h3>
<p>Les composants utilisés sont :</p>
<h4 id=carte>Carte</h4>
<p>C&rsquo;est un Wemos D1 mini, contenant un module ESP8266.
On peut trouver des informations sur le site du fabriquant : <a href=https://www.wemos.cc/en/latest/d1/d1_mini.html>https://www.wemos.cc/en/latest/d1/d1_mini.html</a>.</p>
<p>On peut en trouver pour 5 € ou moins sur des sites bien connus (attention au coût de la livraison cependant).</p>
<p>Cette carte inclut un chipset Wifi que l&rsquo;on utilisera pour détecter le signal.</p>
<p><strong>Recto</strong></p>
<p><img src=images/wemos_recto.jpg alt></p>
<p><strong>Verso</strong></p>
<p><img src=images/wemos_verso.jpg alt></p>
<h4 id=bande-led>Bande LED</h4>
<p>Je n&rsquo;ai pas trop d&rsquo;infos sur le modèle, mais on peut voir sur la photo que c&rsquo;est une bande la marque 3M, modèle <em>200 MP</em> ?</p>
<p>Il y 30 LEDs sur cette bande.</p>
<p><img src=images/led_stripe.jpg alt></p>
<h4 id=batterie>Batterie</h4>
<p>Pour alimenter la carte, il faut un voltage classique de 3.3 V ou via micro-USB (5V).</p>
<p>Quand la carte n&rsquo;est pas connectée à l&rsquo;ordinateur, j&rsquo;utilise une batterie externe classique.</p>
<p><img src=images/battery.jpg alt></p>
<h4 id=assemblage-final>Assemblage final</h4>
<p>L&rsquo;assemblage final ressemble à :</p>
<p><img src=images/final_assembly.jpg alt></p>
<h3 id=software>Software</h3>
<p>Le code sera en C, et pas très long.</p>
<p>Pour coder et communiquer avec la carte, la solution la plus directe est d&rsquo;utiliser l&rsquo;IDE Arduino.</p>
<p>Tout d&rsquo;abord, il faut configurer la carte dans l&rsquo;IDE.
La documentation décrit la procédure ici : <a href=https://arduino-esp8266.readthedocs.io/en/latest/installing.html>https://arduino-esp8266.readthedocs.io/en/latest/installing.html</a>.</p>
<p>Essentiellement, il faut :</p>
<ul>
<li>aller dans <em>Préférences</em> et mettre l&rsquo;url <a href=http://arduino.esp8266.com/stable/package_esp8266com_index.json>http://arduino.esp8266.com/stable/package_esp8266com_index.json</a> dans l&rsquo;URL de gestionnaire de cartes supplémentaires</li>
<li>puis aller dans <em>Outils > Type de carte [&mldr;] > Gestionnaire de carte</em> et installer la carte <code>esp8266</code>, cela nous donnera accès à la bibliothèque Wifi</li>
</ul>
<p>J&rsquo;ai ensuite utilisé ces réglages pour la carte :</p>
<p><img src=images/arduino_ide_settings.png alt></p>
<p>Enfin, pour communiquer avec la bande LED, il faut installer la bibliothèque (avec l&rsquo;outil de gestion des bibliothèques de l&rsquo;IDE) <code>Adafruit_NeoPixel</code>, dont le le projet Github est ici : <a href=https://github.com/adafruit/Adafruit_NeoPixel>https://github.com/adafruit/Adafruit_NeoPixel</a>.</p>
<blockquote>
<p><strong>Note</strong> : Il est également possible d&rsquo;utiliser VS Code pour coder et communiquer avec la carte 😎 !
Il faut en pré-requis avoir quand même installé l&rsquo;Arduino IDE (ou CLI).
Pour cela j&rsquo;ai installé les extensions suivantes :</p>
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.vscode-arduino">Arduino</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools">C/C++</a></li>
</ul>
<p>Ouvrir ensuite l&rsquo;Arduino Board Manager (⌘⇧P) et sélectionner <em>Arduino: Board Manager</em>.
Sélectionner ensuite <em>LOLIN(WEMOS) D1 R2 & mini</em>.
En bas à droite de VS Code, cliquer sur <em>serial port</em> pour sélectionner le bon port USB.</p>
<p>Pour vérifier que le code est bon : ⌥⌘R.</p>
<p>Pour envoyer le sketch sur la carte : ⌥⌘U.</p>
<p><img src=images/vscode_arduino.png alt></p>
</blockquote>
<h2 id=code>Code</h2>
<p>Les documentations suivantes ont été utiles :</p>
<ul>
<li>Module Wifi : <a href=https://arduino-esp8266.readthedocs.io/en/latest/esp8266wifi/readme.html>https://arduino-esp8266.readthedocs.io/en/latest/esp8266wifi/readme.html</a></li>
<li>Bande LED : <a href=https://adafruit.github.io/Adafruit_NeoPixel/html/class_adafruit___neo_pixel.html>https://adafruit.github.io/Adafruit_NeoPixel/html/class_adafruit___neo_pixel.html</a></li>
</ul>
<p>De plus, ce site permet de tester <em>online</em> le code, sans passer par l&rsquo;upload sur la carte !!!
<a href=https://wokwi.com/arduino/libraries/Adafruit_NeoPixel>https://wokwi.com/arduino/libraries/Adafruit_NeoPixel</a></p>
<p>Le code en lui même est assez basique :</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;Adafruit_NeoPixel.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ESP8266WiFi.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define LED_PIN D4
</span><span style=color:#75715e>#define LED_COUNT 30
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define SCAN_DELAY 500
</span><span style=color:#75715e></span>
<span style=color:#75715e>// See https://fr.wikipedia.org/wiki/Received_Signal_Strength_Indication
</span><span style=color:#75715e></span><span style=color:#75715e>#define RSSI_BEST -30
</span><span style=color:#75715e>#define RSSI_WORST -90
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define WIFI_SSID &#34;SSID  du réseau à analyser&#34;
</span><span style=color:#75715e></span>
Adafruit_NeoPixel <span style=color:#a6e22e>strip</span>(LED_COUNT, LED_PIN, NEO_GRB <span style=color:#f92672>+</span> NEO_KHZ800);
WiFiClient client;
<span style=color:#66d9ef>int</span> step;

<span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setup</span>()
{

    step <span style=color:#f92672>=</span> (RSSI_BEST <span style=color:#f92672>-</span> RSSI_WORST) <span style=color:#f92672>/</span> LED_COUNT;

    Serial.begin(<span style=color:#ae81ff>9600</span>);
    Serial.print(F(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Wifi Scan Example&#34;</span>));

    strip.begin();
    strip.setBrightness(<span style=color:#ae81ff>20</span>);

    WiFi.mode(WIFI_STA);
    WiFi.scanDelete();
    WiFi.disconnect();

    delay(<span style=color:#ae81ff>100</span>);
}

<span style=color:#66d9ef>void</span> <span style=color:#a6e22e>loop</span>()
{
    String ssid;
    <span style=color:#66d9ef>int32_t</span> rssi;
    <span style=color:#66d9ef>uint8_t</span> encryptionType;
    <span style=color:#66d9ef>uint8_t</span> <span style=color:#f92672>*</span>bssid;
    <span style=color:#66d9ef>int32_t</span> channel;
    <span style=color:#66d9ef>bool</span> hidden;
    <span style=color:#66d9ef>bool</span> found <span style=color:#f92672>=</span> false;

    Serial.println(F(<span style=color:#e6db74>&#34;Starting WiFi scan...&#34;</span>));
    <span style=color:#66d9ef>int</span> numberOfNetworks <span style=color:#f92672>=</span> WiFi.scanNetworks(<span style=color:#75715e>/*async=*/</span>false, <span style=color:#75715e>/*hidden=*/</span>true);

    <span style=color:#66d9ef>if</span> (numberOfNetworks <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)
    {
        Serial.printf(PSTR(<span style=color:#e6db74>&#34;%d networks found:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>), numberOfNetworks);

        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> numberOfNetworks; i<span style=color:#f92672>++</span>)
        {
            WiFi.getNetworkInfo(i, ssid, encryptionType, rssi, bssid, channel, hidden);
            Serial.printf(PSTR(<span style=color:#e6db74>&#34;Network %d: name=%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>), i, ssid.c_str());
            <span style=color:#66d9ef>if</span> (ssid <span style=color:#f92672>==</span> WIFI_SSID)
            {
                found <span style=color:#f92672>=</span> true;
                <span style=color:#66d9ef>break</span>;
            }
        }
    }

    <span style=color:#66d9ef>if</span> (found)
    {
        <span style=color:#66d9ef>int</span> numberOfLeds <span style=color:#f92672>=</span> LED_COUNT <span style=color:#f92672>-</span> (RSSI_BEST <span style=color:#f92672>-</span> rssi) <span style=color:#f92672>/</span> step;
        Serial.printf(PSTR(<span style=color:#e6db74>&#34;Found our network %s with rssi %d</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>), WIFI_SSID, rssi);

        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> LED_COUNT; j<span style=color:#f92672>++</span>)
        {
            <span style=color:#66d9ef>if</span> (j <span style=color:#f92672>&lt;</span> numberOfLeds)
            {
                <span style=color:#66d9ef>if</span> (j <span style=color:#f92672>&lt;</span> LED_COUNT <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>)
                {
                    strip.setPixelColor(j, strip.Color(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>));
                }
                <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (j <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> LED_COUNT <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>)
                {
                    strip.setPixelColor(j, strip.Color(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>127</span>, <span style=color:#ae81ff>0</span>));
                }
                <span style=color:#66d9ef>else</span>
                {
                    strip.setPixelColor(j, strip.Color(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>));
                }
            }
            <span style=color:#66d9ef>else</span>
            {
                strip.setPixelColor(j, strip.Color(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>));
            }
        }
    }
    <span style=color:#66d9ef>else</span>
    {
        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> LED_COUNT; j<span style=color:#f92672>++</span>)
        {
            <span style=color:#66d9ef>if</span> (j <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
            {
                strip.setPixelColor(j, strip.Color(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>60</span>));
            }
            <span style=color:#66d9ef>else</span>
            {
                strip.setPixelColor(j, strip.Color(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>200</span>));
            }
        }
    }

    strip.show();

    <span style=color:#75715e>// Wait a bit before scanning again
</span><span style=color:#75715e></span>    delay(SCAN_DELAY);
}
</code></pre></div><ul>
<li>
<p><code>LED_COUNT</code> contient le nombre de LEDs de la bande LED</p>
</li>
<li>
<p>Pour le calcul de la force du signal, on a une information RSSI (<em>Received Signal Strength Indication</em>) qui n&rsquo;est qu&rsquo;une indication et pas une échelle de valeur précise.
La <a href=https://fr.wikipedia.org/wiki/Received_Signal_Strength_Indication>page Wikipedia de RSSI</a> précise que pour du Wifi, -30 dBm est élevé, et -90 dBm est à la limite de la réception du signal.</p>
</li>
<li>
<p>Dans <code>WIFI_SSID</code>, il faut mettre le nom du réseau Wifi que l&rsquo;on souhaite analyser.</p>
</li>
<li>
<p>Le code lance un scan des réseaux Wifi disponibles :</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>int</span> numberOfNetworks <span style=color:#f92672>=</span> WiFi.scanNetworks(<span style=color:#75715e>/*async=*/</span>false, <span style=color:#75715e>/*hidden=*/</span>true);
</code></pre></div></li>
<li>
<p>Puis boucle sur la liste des réseaux jusqu&rsquo;à trouver celui correspondant au SSID indiqué :</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> numberOfNetworks; i<span style=color:#f92672>++</span>)
{
    WiFi.getNetworkInfo(i, ssid, encryptionType, rssi, bssid, channel, hidden);
    <span style=color:#66d9ef>if</span> (ssid <span style=color:#f92672>==</span> WIFI_SSID)
    {
      found <span style=color:#f92672>=</span> true;
      <span style=color:#66d9ef>break</span>;
    }
}
</code></pre></div><p>Il récupère par la même occasion la force du signal dans la variable <code>rssi</code>.</p>
</li>
<li>
<p>On calcule le nombre de LEDs qu&rsquo;il faut allumer en fonction de la force du signal : peu de LEDs si le signal est faible, beaucoup si le signal est fort :</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>int</span> numberOfLeds <span style=color:#f92672>=</span> LED_COUNT <span style=color:#f92672>-</span> (RSSI_BEST <span style=color:#f92672>-</span> rssi) <span style=color:#f92672>/</span> step;
</code></pre></div><p>Le reste sert à mettre des couleurs rouge, orange ou vert.</p>
</li>
<li>
<p>Si aucun signal n&rsquo;est détecté, alors on allume une LED sur deux en bleu intense ou faible.</p>
</li>
<li>
<p>Enfin, on attend une demi-seconde et on recommence.</p>
</li>
</ul>
<h2 id=démo-time->Démo time !</h2>
<p>En étant à côté de la box, le signal est fort !</p>
<p><img src=images/strong_signal.jpg alt></p>
<p>Un peu plus loin, et avec une casserole sur la tête, le signal est plus faible :</p>
<p><img src=images/weak_signal.jpg alt></p>
<p>Enfin, sans signal (en fait, j&rsquo;ai triché, j&rsquo;ai modifié le SSID pour en mettre un qui n&rsquo;existe pas 😅) :</p>
<p><img src=images/no_signal.jpg alt></p>
<h2 id=conclusion>Conclusion</h2>
<p>Jouer avec les composants électroniques, c&rsquo;est fun !
Même si mes cours de C datent de &mldr; pfiou &mldr; c&rsquo;est vraiment sympa de voir un objet physique réagir à son environnement en fonction de ce que l&rsquo;on a programmé (même si ici, c&rsquo;est très <em>très</em> modeste).</p>
<h2 id=crédits>Crédits</h2>
<p>La photo de l&rsquo;article est de <a href=https://www.pexels.com/@cottonbro>cottonbro</a> depuis le site Pexels.</p>
<p><a href=https://www.pexels.com/photo/wood-city-street-banner-5599613/>https://www.pexels.com/photo/wood-city-street-banner-5599613/</a></p>
<ul class=pa0>
<li class=list>
<a href=/fr/tags/wifi class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">wifi</a>
</li>
<li class=list>
<a href=/fr/tags/arduino class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">arduino</a>
</li>
<li class=list>
<a href=/fr/tags/esp8266 class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">esp8266</a>
</li>
<li class=list>
<a href=/fr/tags/clever-cloud class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">clever-cloud</a>
</li>
</ul>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">Table des matières</p>
<nav id=TableOfContents>
<ul>
<li><a href=#préparation>Préparation</a>
<ul>
<li><a href=#composants>Composants</a></li>
<li><a href=#software>Software</a></li>
</ul>
</li>
<li><a href=#code>Code</a></li>
<li><a href=#démo-time->Démo time !</a></li>
<li><a href=#conclusion>Conclusion</a></li>
<li><a href=#crédits>Crédits</a></li>
</ul>
</nav>
</div>
</aside>
</article>
</main>
<footer class="bg-dark-gray bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://blog.deraco.fr/>
&copy; Blog de Stéphane
2021
</a>
<div>
<a class="f8 fw4 hover-white no-underline white-40 dn dib-ns pv2 ph3" rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>Contenu sous licence : <img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png></a>
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=/fr/credits>Crédits</a>
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=/fr/terms>Mentions légales</a>
</div>
<div>
<a href=https://twitter.com/stephane_deraco target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/st%C3%A9phane-deraco-964640194/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/stephane-deraco target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://blog.deraco.fr/fr/index.xml target=_blank class="link-transition rss link dib z-999 pt3 pt0-l mr1" title="RSS link" rel=noopener aria-label="RSS——Opens in a new window"><svg xmlns="http://www.w3.org/2000/svg" height="32" width="32" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</footer>
</body>
</html>